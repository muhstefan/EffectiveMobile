{% extends "base.html" %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ - –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏{% endblock %}

{% block content %}
<div class="create-order-container">
    <div class="create-order-header">
        <h1>üõí –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</h1>
        <a href="/business/products" class="btn btn-outline">‚Üê –ö –ø—Ä–æ–¥—É–∫—Ç–∞–º</a>
    </div>
    
    {% if error %}
        <div class="alert alert-error">{{ error }}</div>
    {% endif %}
    
    <div class="create-order-form">
        <form method="post" action="/business/orders/create" class="order-form">
            <div class="form-group">
                <label for="product_id">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç:</label>
                <select id="product_id" name="product_id" required>
                    {% if selected_product %}
                        <option value="{{ selected_product.id }}" selected>
                            {{ selected_product.name }} - {{ selected_product.price }} ‚ÇΩ
                        </option>
                    {% else %}
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–¥—É–∫—Ç</option>
                        {% for product in products %}
                            <option value="{{ product.id }}">
                                {{ product.name }} - {{ product.price }} ‚ÇΩ
                            </option>
                        {% endfor %}
                    {% endif %}
                </select>
            </div>
            
            <div class="form-group">
                <label for="quantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                <input type="number" id="quantity" name="quantity" min="1" value="1" required>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</button>
                <a href="/business/products" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</a>
            </div>
        </form>
    </div>
    
    {% if selected_product %}
    <div class="product-preview">
        <h3>–í—ã–±—Ä–∞–Ω–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç:</h3>
        <div class="product-card">
            <div class="product-header">
                <h4>{{ selected_product.name }}</h4>
                <span class="product-category">{{ selected_product.category }}</span>
            </div>
            {% if selected_product.description %}
            <p class="product-description">{{ selected_product.description }}</p>
            {% endif %}
            <div class="product-price">{{ selected_product.price }} ‚ÇΩ</div>
        </div>
    </div>
    {% endif %}
</div>

<script>
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
document.getElementById('quantity').addEventListener('input', function() {
    const quantity = parseInt(this.value) || 0;
    const productSelect = document.getElementById('product_id');
    const selectedOption = productSelect.options[productSelect.selectedIndex];
    
    if (selectedOption.value) {
        const priceText = selectedOption.text.split(' - ')[1];
        const price = parseFloat(priceText.replace(' ‚ÇΩ', ''));
        const total = price * quantity;
        
        // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–±—â–µ–π —Å—É–º–º—ã
        console.log(`–û–±—â–∞—è —Å—É–º–º–∞: ${total} ‚ÇΩ`);
    }
});
</script>
{% endblock %}

