{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ - –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å{% endblock %}

{% block content %}
<div class="admin-panel">
    <div class="admin-header">
        <h1>üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>
        <a href="/admin" class="btn btn-secondary">‚Üê –ù–∞–∑–∞–¥ –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å</a>
    </div>
    
    {% if error %}
        <div class="alert alert-error">{{ error }}</div>
    {% endif %}
    
    {% if success %}
        <div class="alert alert-success">{{ success }}</div>
    {% endif %}
    
    <div class="admin-actions">
        <button onclick="showCreateUserForm()" class="btn btn-primary">+ –°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
    </div>
    
    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="createUserForm" class="form-container" style="display: none;">
        <h3>–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
        <form method="post" action="/admin/users/create">
            <div class="form-group">
                <label for="first_name">–ò–º—è:</label>
                <input type="text" id="first_name" name="first_name" required>
            </div>
            <div class="form-group">
                <label for="last_name">–§–∞–º–∏–ª–∏—è:</label>
                <input type="text" id="last_name" name="last_name" required>
            </div>
            <div class="form-group">
                <label for="middle_name">–û—Ç—á–µ—Å—Ç–≤–æ:</label>
                <input type="text" id="middle_name" name="middle_name">
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="password" name="password" required>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
                <button type="button" onclick="hideCreateUserForm()" class="btn btn-secondary">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </form>
    </div>
    
    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <div class="users-list">
        <h3>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
        <div class="table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ò–º—è</th>
                        <th>Email</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–†–æ–ª–∏</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ user.id[:8] }}...</td>
                        <td>{{ user.first_name }} {{ user.last_name }}</td>
                        <td>{{ user.email }}</td>
                        <td>
                            <span class="status status-{{ user.status }}">{{ user.status }}</span>
                        </td>
                        <td>
                            {% for role in user.roles %}
                                <span class="role-tag">{{ role.name }}</span>
                            {% endfor %}
                        </td>
                        <td>
                            <a href="/admin/users/{{ user.id }}/edit" class="btn btn-sm btn-primary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                            {% if user.status == "active" %}
                                <form method="post" action="/admin/users/{{ user.id }}/delete" style="display: inline;">
                                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')">–£–¥–∞–ª–∏—Ç—å</button>
                                </form>
                            {% else %}
                                <form method="post" action="/admin/users/{{ user.id }}/restore" style="display: inline;">
                                    <button type="submit" class="btn btn-sm btn-success">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                                </form>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
function showCreateUserForm() {
    document.getElementById('createUserForm').style.display = 'block';
}

function hideCreateUserForm() {
    document.getElementById('createUserForm').style.display = 'none';
}
</script>
{% endblock %}
